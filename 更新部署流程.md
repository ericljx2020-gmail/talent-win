# ç½‘ç«™æ›´æ–°éƒ¨ç½²æµç¨‹

## ðŸ”„ å®Œæ•´æ›´æ–°æµç¨‹

### æ–¹æ¡ˆAï¼šä½¿ç”¨Gitï¼ˆæŽ¨èï¼‰

è¿™æ˜¯æœ€è§„èŒƒå’Œä¾¿æ·çš„æ–¹å¼ã€‚

#### å‡†å¤‡å·¥ä½œï¼ˆä¸€æ¬¡æ€§è®¾ç½®ï¼‰

**1. åœ¨GitHubåˆ›å»ºä»“åº“**

```bash
# åœ¨æœ¬åœ°Macç”µè„‘ä¸Šï¼ˆtalent-winé¡¹ç›®ç›®å½•ï¼‰
cd /Users/eureka/Desktop/Projects/talent-win

# åˆå§‹åŒ–Gitï¼ˆå¦‚æžœè¿˜æ²¡æœ‰ï¼‰
git init

# åˆ›å»º .gitignoreï¼ˆå¦‚æžœè¿˜æ²¡æœ‰ï¼‰
cat > .gitignore << 'EOF'
node_modules/
dist/
.env
.DS_Store
*.log
EOF

# æäº¤æ‰€æœ‰ä»£ç 
git add .
git commit -m "Initial commit"

# å…³è”GitHubä»“åº“ï¼ˆæ›¿æ¢ä¸ºä½ çš„ä»“åº“åœ°å€ï¼‰
git remote add origin https://github.com/your-username/talent-win.git
git branch -M main
git push -u origin main
```

**2. åœ¨æœåŠ¡å™¨ä¸Šå…‹éš†ä»“åº“ï¼ˆé¦–æ¬¡ï¼‰**

```bash
# SSHç™»å½•åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨
ssh root@8.153.166.197

# å¦‚æžœä¹‹å‰æ˜¯ç”¨SCPä¸Šä¼ çš„ï¼Œå…ˆå¤‡ä»½å¹¶åˆ é™¤
cd /root
mv talent-win talent-win-backup

# å…‹éš†GitHubä»“åº“
git clone https://github.com/your-username/talent-win.git
cd talent-win
```

#### æ—¥å¸¸æ›´æ–°æµç¨‹

**æ­¥éª¤1ï¼šåœ¨æœ¬åœ°ä¿®æ”¹ä»£ç **

```bash
# åœ¨ä½ çš„Macç”µè„‘ä¸Šä¿®æ”¹ä»£ç 
# æ¯”å¦‚ä¿®æ”¹ src/components/Hero.tsx ç­‰æ–‡ä»¶
```

**æ­¥éª¤2ï¼šæäº¤ä»£ç åˆ°GitHub**

```bash
# åœ¨æœ¬åœ°é¡¹ç›®ç›®å½•
cd /Users/eureka/Desktop/Projects/talent-win

# æŸ¥çœ‹ä¿®æ”¹çš„æ–‡ä»¶
git status

# æ·»åŠ ä¿®æ”¹çš„æ–‡ä»¶
git add .

# æäº¤ä¿®æ”¹ï¼ˆå†™æ¸…æ¥šæ”¹äº†ä»€ä¹ˆï¼‰
git commit -m "æ›´æ–°äº†é¦–é¡µæ ‡é¢˜å’Œè”ç³»è¡¨å•"

# æŽ¨é€åˆ°GitHub
git push origin main
```

**æ­¥éª¤3ï¼šåœ¨æœåŠ¡å™¨ä¸Šæ›´æ–°éƒ¨ç½²**

```bash
# SSHç™»å½•åˆ°æœåŠ¡å™¨
ssh root@8.153.166.197

# è¿›å…¥é¡¹ç›®ç›®å½•
cd /root/talent-win

# æ–¹æ³•1ï¼šä½¿ç”¨è‡ªåŠ¨éƒ¨ç½²è„šæœ¬ï¼ˆæŽ¨èï¼‰
./deploy-aliyun.sh
# ç„¶åŽé€‰æ‹©ï¼š2ï¼ˆæ›´æ–°éƒ¨ç½²ï¼‰

# æ–¹æ³•2ï¼šæ‰‹åŠ¨æ‰§è¡Œ
git pull origin main              # æ‹‰å–æœ€æ–°ä»£ç 
docker-compose down               # åœæ­¢æ—§å®¹å™¨
docker-compose up -d --build      # é‡æ–°æž„å»ºå¹¶å¯åŠ¨
docker image prune -f             # æ¸…ç†æ—§é•œåƒ
```

**æ­¥éª¤4ï¼šéªŒè¯æ›´æ–°**

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—ï¼ˆç¡®ä¿æ²¡æœ‰é”™è¯¯ï¼‰
docker-compose logs -f --tail=50

# åœ¨æµè§ˆå™¨è®¿é—®æµ‹è¯•
# http://8.153.166.197:8080
```

---

### æ–¹æ¡ˆBï¼šä½¿ç”¨SCPä¸Šä¼ ï¼ˆä¸æŽ¨èï¼Œä½†å¯ç”¨ï¼‰

å¦‚æžœæš‚æ—¶ä¸æƒ³ç”¨Gitï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥ä¸Šä¼ æ–‡ä»¶ã€‚

**æ­¥éª¤1ï¼šåœ¨æœ¬åœ°æ‰“åŒ…é¡¹ç›®**

```bash
# åœ¨Macç”µè„‘ä¸Š
cd /Users/eureka/Desktop/Projects/talent-win

# æ‰“åŒ…é¡¹ç›®ï¼ˆæŽ’é™¤ä¸éœ€è¦çš„æ–‡ä»¶ï¼‰
tar --exclude='node_modules' \
    --exclude='dist' \
    --exclude='.git' \
    --exclude='.DS_Store' \
    -czf talent-win-update.tar.gz .
```

**æ­¥éª¤2ï¼šä¸Šä¼ åˆ°æœåŠ¡å™¨**

```bash
# ä¸Šä¼ åŽ‹ç¼©åŒ…
scp talent-win-update.tar.gz root@8.153.166.197:/root/

# SSHç™»å½•åˆ°æœåŠ¡å™¨
ssh root@8.153.166.197
```

**æ­¥éª¤3ï¼šè§£åŽ‹å¹¶éƒ¨ç½²**

```bash
# åœæ­¢æœåŠ¡
cd /root/talent-win
docker-compose down

# å¤‡ä»½å½“å‰ç‰ˆæœ¬ï¼ˆå¯é€‰ä½†æŽ¨èï¼‰
cd /root
cp -r talent-win talent-win-backup-$(date +%Y%m%d)

# è§£åŽ‹æ–°ä»£ç ï¼ˆè¦†ç›–æ—§æ–‡ä»¶ï¼‰
cd /root/talent-win
tar -xzf ../talent-win-update.tar.gz

# é‡æ–°éƒ¨ç½²
docker-compose up -d --build
docker image prune -f

# æ¸…ç†åŽ‹ç¼©åŒ…
rm /root/talent-win-update.tar.gz
```

**æ­¥éª¤4ï¼šéªŒè¯æ›´æ–°**

```bash
docker-compose ps
docker-compose logs -f --tail=50
```

---

## ðŸ“‹ æ›´æ–°æ£€æŸ¥æ¸…å•

æ›´æ–°å‰æ£€æŸ¥ï¼š
- [ ] æœ¬åœ°ä»£ç å·²æµ‹è¯•æ— è¯¯
- [ ] å·²æäº¤æ‰€æœ‰ä¿®æ”¹åˆ°Gitï¼ˆå¦‚æžœä½¿ç”¨Gitï¼‰
- [ ] è®°å½•äº†æœ¬æ¬¡ä¿®æ”¹çš„å†…å®¹

æ›´æ–°åŽæ£€æŸ¥ï¼š
- [ ] å®¹å™¨çŠ¶æ€æ­£å¸¸ï¼ˆ`docker-compose ps` æ˜¾ç¤º Upï¼‰
- [ ] æ—¥å¿—æ— é”™è¯¯ä¿¡æ¯
- [ ] ç½‘ç«™å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] å…³é”®åŠŸèƒ½æµ‹è¯•é€šè¿‡ï¼ˆå¯¼èˆªã€è¡¨å•ç­‰ï¼‰

---

## âš¡ å¿«æ·å‘½ä»¤

```bash
# ========== æœ¬åœ°ï¼ˆMacï¼‰==========

# æäº¤å¹¶æŽ¨é€ä»£ç 
git add . && git commit -m "æ›´æ–°è¯´æ˜Ž" && git push

# è¿žæŽ¥åˆ°æœåŠ¡å™¨
ssh root@8.153.166.197

# ========== æœåŠ¡å™¨ ==========

# å¿«é€Ÿæ›´æ–°ï¼ˆä¸€è¡Œå‘½ä»¤ï¼‰
cd /root/talent-win && git pull && docker-compose down && docker-compose up -d --build && docker image prune -f

# æˆ–ä½¿ç”¨è„šæœ¬ï¼ˆæŽ¨èï¼‰
cd /root/talent-win && ./deploy-aliyun.sh
# é€‰æ‹©ï¼š2

# æŸ¥çœ‹çŠ¶æ€
docker-compose ps

# å®žæ—¶æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# é‡å¯æœåŠ¡ï¼ˆä¸é‡æ–°æž„å»ºï¼‰
docker-compose restart

# æŸ¥çœ‹èµ„æºä½¿ç”¨
docker stats talent-win-web
```

---

## ðŸš¨ å¸¸è§é—®é¢˜

### æ›´æ–°åŽç½‘ç«™æ²¡æœ‰å˜åŒ–ï¼Ÿ

**åŽŸå› ï¼š** æµè§ˆå™¨ç¼“å­˜

**è§£å†³ï¼š**
- æŒ‰ `Ctrl+Shift+R`ï¼ˆWindowsï¼‰æˆ– `Cmd+Shift+R`ï¼ˆMacï¼‰å¼ºåˆ¶åˆ·æ–°
- æˆ–è€…æ¸…é™¤æµè§ˆå™¨ç¼“å­˜

### Gitæ‹‰å–å¤±è´¥ï¼Ÿ

```bash
# æŸ¥çœ‹çŠ¶æ€
git status

# å¦‚æžœæœ‰æœ¬åœ°ä¿®æ”¹å†²çªï¼Œå…ˆä¿å­˜
git stash

# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# æ¢å¤æœ¬åœ°ä¿®æ”¹ï¼ˆå¦‚æžœéœ€è¦ï¼‰
git stash pop
```

### æž„å»ºå¤±è´¥ï¼Ÿ

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
docker-compose up --build

# æ¸…ç†æ‰€æœ‰å®¹å™¨å’Œé•œåƒé‡æ–°å¼€å§‹
docker-compose down
docker system prune -a
docker-compose up -d --build
```

### å›žæ»šåˆ°ä¹‹å‰çš„ç‰ˆæœ¬

**å¦‚æžœä½¿ç”¨Gitï¼š**
```bash
# æŸ¥çœ‹æäº¤åŽ†å²
git log --oneline

# å›žæ»šåˆ°æŒ‡å®šç‰ˆæœ¬ï¼ˆæ›¿æ¢commit-idï¼‰
git reset --hard <commit-id>
docker-compose down
docker-compose up -d --build
```

**å¦‚æžœæœ‰å¤‡ä»½ï¼š**
```bash
# åœæ­¢æœåŠ¡
cd /root/talent-win
docker-compose down

# æ¢å¤å¤‡ä»½
cd /root
rm -rf talent-win
cp -r talent-win-backup-20241029 talent-win

# é‡æ–°å¯åŠ¨
cd talent-win
docker-compose up -d
```

---

## ðŸ’¡ æœ€ä½³å®žè·µ

### 1. ä½¿ç”¨åˆ†æ”¯å¼€å‘

```bash
# åˆ›å»ºå¼€å‘åˆ†æ”¯
git checkout -b dev

# åœ¨å¼€å‘åˆ†æ”¯ä¸Šä¿®æ”¹å’Œæµ‹è¯•
# ... ä¿®æ”¹ä»£ç  ...
git add .
git commit -m "æ–°åŠŸèƒ½å¼€å‘"

# æµ‹è¯•é€šè¿‡åŽåˆå¹¶åˆ°ä¸»åˆ†æ”¯
git checkout main
git merge dev
git push origin main

# ç„¶åŽåœ¨æœåŠ¡å™¨ä¸Šæ‹‰å–æ›´æ–°
```

### 2. ç‰ˆæœ¬æ ‡ç­¾ç®¡ç†

```bash
# æ‰“æ ‡ç­¾æ ‡è®°é‡è¦ç‰ˆæœ¬
git tag -a v1.0.0 -m "ç¬¬ä¸€ä¸ªæ­£å¼ç‰ˆæœ¬"
git push origin v1.0.0

# æŸ¥çœ‹æ‰€æœ‰æ ‡ç­¾
git tag

# å›žæ»šåˆ°ç‰¹å®šæ ‡ç­¾
git checkout v1.0.0
```

### 3. è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼ˆè¿›é˜¶ï¼‰

å¯ä»¥ä½¿ç”¨GitHub Actionså®žçŽ°è‡ªåŠ¨éƒ¨ç½²ï¼š

**åˆ›å»º `.github/workflows/deploy.yml`ï¼š**

```yaml
name: Deploy to Aliyun

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to server
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SERVER_SSH_KEY }}
          script: |
            cd /root/talent-win
            git pull origin main
            docker-compose down
            docker-compose up -d --build
            docker image prune -f
```

è¿™æ ·æ¯æ¬¡ `git push` å°±ä¼šè‡ªåŠ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼

### 4. å®šæœŸå¤‡ä»½

```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬
cat > /root/backup-website.sh << 'EOF'
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/root/backups"
mkdir -p $BACKUP_DIR

# å¤‡ä»½ä»£ç 
tar -czf $BACKUP_DIR/talent-win-$DATE.tar.gz /root/talent-win

# åªä¿ç•™æœ€è¿‘7å¤©çš„å¤‡ä»½
find $BACKUP_DIR -name "talent-win-*.tar.gz" -mtime +7 -delete

echo "å¤‡ä»½å®Œæˆ: talent-win-$DATE.tar.gz"
EOF

chmod +x /root/backup-website.sh

# æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½ï¼‰
crontab -e
# æ·»åŠ ï¼š0 2 * * * /root/backup-website.sh
```

---

## ðŸ“ž éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æžœæ›´æ–°è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹æ—¥å¿—ï¼š`docker-compose logs -f`
2. æ£€æŸ¥å®¹å™¨çŠ¶æ€ï¼š`docker-compose ps`
3. æ£€æŸ¥ç£ç›˜ç©ºé—´ï¼š`df -h`
4. æ£€æŸ¥å†…å­˜ä½¿ç”¨ï¼š`free -h`

---

**æ€»ç»“ï¼šæŽ¨èä½¿ç”¨ Git + è‡ªåŠ¨è„šæœ¬çš„æ–¹å¼ï¼Œç®€å•ã€å®‰å…¨ã€å¯è¿½æº¯ï¼** ðŸš€

