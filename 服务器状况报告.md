# 📊 TalentWin 服务器状况报告

> 生成时间：2025-10-29

---

## 🖥️ 服务器基本信息

### 系统配置
- **服务器IP：** 8.153.166.197
- **操作系统：** Linux (Ubuntu/Debian)
- **磁盘容量：** 40GB（已使用 4GB，剩余 34GB，使用率 11%）
- **内存：** 1.6GB（已使用 604MB，可用 829MB）
- **Swap：** 未配置（0B）

### 资源使用情况
```
磁盘：  ████░░░░░░░░░░░░░░░░ 11%  (4GB / 40GB)
内存：  ███████░░░░░░░ 38%  (604MB / 1.6GB)
```

✅ **状态：** 资源充足，运行正常

---

## 🐳 Docker 容器部署架构

### 是的，您的应用完全运行在 Docker 容器中！

```
┌─────────────────────────────────────────────────────┐
│            阿里云 ECS 服务器                          │
│         IP: 8.153.166.197                           │
│                                                     │
│  ┌───────────────────────────────────────────┐     │
│  │         Docker Engine                     │     │
│  │                                           │     │
│  │  ┌─────────────────────────────────┐     │     │
│  │  │  talent-win-web 容器            │     │     │
│  │  │  (Container ID: 442a9957069f)  │     │     │
│  │  │                                 │     │     │
│  │  │  ┌─────────────────────────┐   │     │     │
│  │  │  │   Nginx Web Server      │   │     │     │
│  │  │  │   (端口 80)              │   │     │     │
│  │  │  └──────────┬──────────────┘   │     │     │
│  │  │             │                   │     │     │
│  │  │  ┌──────────▼──────────────┐   │     │     │
│  │  │  │  React 静态文件         │   │     │     │
│  │  │  │  (编译后的网站)          │   │     │     │
│  │  │  └─────────────────────────┘   │     │     │
│  │  │                                 │     │     │
│  │  └─────────────┬───────────────────┘     │     │
│  │                │ 端口映射                 │     │
│  │                │ 80 → 8080               │     │
│  └────────────────┼─────────────────────────┘     │
│                   │                               │
└───────────────────┼───────────────────────────────┘
                    │
                    ▼
              互联网访问
         http://8.153.166.197:8080
```

---

## 📦 容器详细信息

### 运行中的容器

| 属性 | 值 |
|------|-----|
| **容器名称** | talent-win-web |
| **镜像名称** | talent-win-talent-win:latest |
| **容器ID** | 442a9957069f |
| **状态** | 运行中 (Up 10 minutes) |
| **端口映射** | 8080:80 (服务器8080 → 容器80) |
| **CPU使用率** | 0.00% (几乎不占用) |
| **内存使用** | 3.4MB (非常低) |
| **进程数** | 3 |

### Docker镜像

| 镜像 | TAG | 大小 | 创建时间 |
|------|-----|------|---------|
| talent-win-talent-win | latest | 53MB | 11分钟前 |

---

## 🔍 容器内部结构

您的应用是通过 **多阶段构建（Multi-stage Build）** 创建的：

### 构建过程

```
第1阶段：构建阶段 (node:18-alpine)
├── 安装 Node.js 和 npm
├── 安装项目依赖 (npm ci)
├── 编译 React 代码 (npm run build)
└── 生成 dist/ 目录 (静态文件)

第2阶段：运行阶段 (nginx:alpine)
├── 只包含 Nginx 和静态文件
├── 复制第1阶段的 dist/ 到 nginx 目录
├── 配置 nginx.conf
└── 最终镜像只有 53MB (非常轻量)
```

### 为什么用 Docker？

✅ **优点：**
- 🎯 **环境一致性** - 本地和服务器完全相同
- 📦 **轻量级** - 整个应用只有 53MB
- 🚀 **快速部署** - 一条命令完成部署
- 🔄 **易于更新** - 重新构建就能更新
- 🛡️ **隔离性** - 不会影响系统其他部分
- 💾 **节省资源** - 只用 3MB 内存

---

## 🔧 常用 Docker 查看命令

### 查看容器状态

```bash
# 查看运行中的容器（推荐）
docker-compose ps

# 查看所有容器（包括停止的）
docker ps -a

# 查看容器详细信息
docker inspect talent-win-web

# 查看容器日志
docker-compose logs
docker-compose logs -f          # 实时查看
docker-compose logs --tail=50   # 最近50行

# 查看容器资源使用
docker stats talent-win-web
docker stats talent-win-web --no-stream  # 快照模式
```

### 查看镜像

```bash
# 查看所有镜像
docker images

# 查看镜像详细信息
docker image inspect talent-win-talent-win

# 查看镜像构建历史
docker history talent-win-talent-win
```

### 进入容器内部

```bash
# 进入容器的 shell（调试用）
docker exec -it talent-win-web sh

# 在容器内执行命令
docker exec talent-win-web ls -la /usr/share/nginx/html

# 查看容器内的文件
docker exec talent-win-web cat /etc/nginx/conf.d/default.conf
```

### 查看网络和端口

```bash
# 查看容器端口映射
docker port talent-win-web

# 查看 Docker 网络
docker network ls

# 测试容器是否响应
curl http://localhost:8080
```

### 系统层面

```bash
# 查看 Docker 系统信息
docker info

# 查看 Docker 磁盘使用
docker system df

# 查看 Docker 版本
docker --version
docker-compose --version
```

---

## 📍 当前访问方式

### 外部访问
```
http://8.153.166.197:8080
```

### 内部访问（在服务器上）
```bash
# 通过宿主机
curl http://localhost:8080

# 直接访问容器
curl http://172.17.0.2:80  # 容器内部IP
```

### 数据流

```
用户浏览器
    ↓
8.153.166.197:8080 (服务器公网IP和端口)
    ↓
Docker 端口映射 (8080 → 80)
    ↓
talent-win-web 容器 (Nginx:80)
    ↓
/usr/share/nginx/html/ (React 静态文件)
    ↓
返回网页给用户
```

---

## ⚠️ 注意事项

### 健康检查状态

当前容器显示为 `unhealthy`，但**应用实际运行正常**。

**原因：** 
- docker-compose.yml 配置了健康检查路径 `/health`
- 但应用没有这个路径（这是静态网站）

**影响：** 
- ❌ 不影响应用运行
- ❌ 不影响用户访问
- ✅ 建议修复配置（下面有解决方案）

---

## 🎯 快速操作命令

```bash
# 查看状态
docker-compose ps

# 查看日志
docker-compose logs -f

# 重启容器
docker-compose restart

# 停止容器
docker-compose down

# 启动容器
docker-compose up -d

# 查看资源
docker stats talent-win-web --no-stream

# 测试访问
curl -I http://localhost:8080
```

---

## 💡 小贴士

1. **容器是临时的**
   - 每次重新构建会创建新容器
   - 旧容器会被删除
   - 但代码在服务器上是持久的

2. **数据在哪里？**
   - 源代码：`/root/talent-win/`
   - 容器内编译后的文件：`/usr/share/nginx/html/`
   - Docker镜像：存储在Docker本地

3. **日志在哪里？**
   - 容器日志：`docker-compose logs`
   - Nginx日志：在容器内部

4. **如何备份？**
   - 备份源代码：`tar -czf backup.tar.gz /root/talent-win/`
   - 备份镜像：`docker save talent-win-talent-win > backup.tar`

---

**总结：您的网站完全在 Docker 容器中运行，隔离、安全、高效！** 🚀

